{% extends 'tapnote/base.html' %}

{% load static %}

{% block content %}
<div class="container mx-auto px-4 py-8 max-w-3xl">
    {% if error %}
    <div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4" role="alert">
        <strong class="font-bold">Error!</strong>
        <span class="block sm:inline">{{ error }}</span>
    </div>
    {% endif %}
    <form method="post" action="{% if note %}{% url 'edit_note' note.hashcode %}{% else %}{% url 'publish' %}{% endif %}" class="space-y-4">
        {% csrf_token %}
        <textarea 
            name="content" 
            class="w-full p-4 focus:outline-none resize-none" 
            style="height:auto; overflow-y:hidden;"
            placeholder="write in markdown"
        >{% if note %}{{ note.content }}{% endif %}</textarea>
        <div class="flex justify-end">
            <button type="submit" class="px-6 py-2 border border-black rounded-full hover:bg-black hover:text-white transition-colors">
                {% if note %}Update{% else %}Publish{% endif %}
            </button>
        </div>
    </form>
    {% if user.is_staff %}
    <div class="mt-8 text-center text-sm text-gray-400">
        <a href="{% url 'migration' %}" class="hover:text-gray-600 underline">Data Migration</a>
    </div>
    {% endif %}
</div>
{% endblock %}

{% block extra_js %}
<script src="{% static 'js/editor.js' %}"></script>
{% endblock %}
